#reveal js: code is automatically not echoed
library(tidyverse)
library(gt)
library(DAAG)
library(car)
library(multcomp)
data(cuckoos)
data(cuckoohosts)
#| echo: true
library(DAAG)
library(tidyverse)
data("cuckoos")
head(cuckoos)
#| echo: false
#| fig-align: center
p <- ggplot(data = cuckoos,
mapping = aes(x = species, y = length))+
geom_boxplot()+
theme_bw()+
theme(axis.text.x = element_text(angle = 30,
hjust = 1, size = 18),
axis.text.y = element_text(size = 18),
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20)) +
labs(x = "Host species", y = "Egg length (mm)")
p
#| echo: true
str(cuckoos$length)
#| echo: true
str(cuckoos$length)
#| echo: true
str(cuckoos$species)
#| echo: true
#| layout-ncol: 2
#| fig-width: 6
#| fig-height: 6
#Histogram
hist(cuckoos$length)
#QQ-Plot
qqPlot(cuckoos$length)
#| echo: false
#| fig-align: center
ggplot(data = cuckoos,
mapping = aes(x = species, y = length))+
geom_boxplot()+
theme_bw()+
theme(axis.text.x = element_text(angle = 30,
hjust = 1, size = 18),
axis.text.y = element_text(size = 18),
axis.title.x = element_text(size = 20),
axis.title.y = element_text(size = 20)) +
labs(x = "Host species", y = "Egg length (mm)")
#| echo: true
one.way <- aov(length ~ species, data = cuckoos)
#| echo: true
one.way <- aov(length ~ species, data = cuckoos)
summary(one.way)
#| echo: true
#| layout-ncol: 2
one.way <- aov(length ~ species, data = cuckoos)
summary(one.way)
one.way2 <- lm(length ~ species, data = cuckoos)
summary(one.way2)
one.way2 <- lm(length ~ species, data = cuckoos)
summary(one.way2)
#| echo: true
tukey <- TukeyHSD(one.way)
tukey
#Extracting significant pairs
tukey_df <- as.data.frame(tukey$species)
names(tukey_df)[names(tukey_df) == "p adj"] <- "p.adj"
sig_pairs <- subset(tukey_df,p.adj < 0.05)
# Create list of comparisons from significant pairs
comparisons <- comparisons <- strsplit(row.names(sig_pairs), "-")
#Creating the plot
library(ggsignif)
ggplot(cuckoos, aes(x = species, y = length)) +
geom_boxplot() +
geom_signif(comparisons = comparisons,
annotations = ifelse(sig_pairs$p.adj < 0.001,   "***",                               ifelse(sig_pairs$p.adj < 0.01, "**",               ifelse(sig_pairs$p.adj < 0.05, "*", ""))),
y_position = seq(25, 35, length.out = nrow(sig_pairs)),
tip_length = 0.02) +
theme_bw()+
theme(axis.text.x = element_text(angle = 30,
hjust = 1, size = 18),
axis.text.y = element_text(size = 18),
axis.title.x = element_text(size = 15),
axis.title.y = element_text(size = 20)) +
labs(x = "Host species", y = "Egg length (mm)")
#| echo: true
#Extracting significant pairs
tukey_df <- as.data.frame(tukey$species)
names(tukey_df)[names(tukey_df) == "p adj"] <- "p.adj"
sig_pairs <- subset(tukey_df,p.adj < 0.05)
# Create list of comparisons from significant pairs
comparisons <- strsplit(row.names(sig_pairs), "-")
#Creating the plot
library(ggsignif)
ggplot(cuckoos, aes(x = species, y = length)) +
geom_boxplot() +
geom_signif(comparisons = comparisons,
annotations = ifelse(sig_pairs$p.adj < 0.001,   "***",                               ifelse(sig_pairs$p.adj < 0.01, "**",               ifelse(sig_pairs$p.adj < 0.05, "*", ""))),
y_position = seq(25, 35, length.out = nrow(sig_pairs)),
tip_length = 0.02) +
theme_bw()+
theme(axis.text.x = element_text(angle = 30,
hjus = 1, size = 18),
axis.text.y = element_text(size = 18),
axis.title.x = element_text(size = 15),
axis.title.y = element_text(size = 20)) +
labs(x = "Host species", y = "Egg length (mm)")
View(comparisons)
tukey_df
View(tukey_df)
names(tukey_df)[names(tukey_df) == "p adj"] <- "p.adj"
sig_pairs <- subset(tukey_df,p.adj < 0.05)
